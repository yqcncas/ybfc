(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-my-myCard"],{2233:function(t,e,n){"use strict";var i=n("ee27");n("d3b7"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("96cf");var a,r=i(n("c964")),c={name:"wm-poster",props:{CanvasID:{Type:String,default:"PosterCanvas"},imgSrc:{Type:String,default:""},QrSrc:{Type:String,default:""},TitleColor:{Type:String,default:"#333333"},LineType:{Type:[String,Boolean],default:!1},OriginalColor:{Type:String,default:"#b8b8b8"},Width:{Type:String,default:750},Height:{Type:String,default:"1048"},CanvasBg:{Type:String,default:"#ffffff"},avatar:{Type:String,default:""},userName:{Type:String,default:""},company:{Type:String,default:""},postName:{Type:String,default:""},years:{Type:String,default:""},visitTimes:{Type:String,default:""}},data:function(){return{canvasW:0,canvasH:0,canvasImgSrc:"",ctx:null}},methods:{OnCanvas:function(){var t=this;return(0,r.default)(regeneratorRuntime.mark((function e(){var n,i,r,c,o,u,s,l,p,d,x,f,g,m,v,h,b,w;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a.ctx=uni.createCanvasContext(a.CanvasID,t),n=uni.upx2px(a.Width),i=uni.upx2px(a.Height),r=uni.upx2px(30),c=uni.upx2px(530),o=uni.upx2px(924),u=uni.upx2px(216),s=uni.upx2px(145),l=uni.upx2px(198),p=uni.upx2px(56),0,e.next=5,a.getImageInfo({imgSrc:a.imgSrc});case 5:return d=e.sent,e.next=8,a.getImageInfo({imgSrc:a.QrSrc});case 8:return x=e.sent,e.next=11,a.getImageInfo({imgSrc:a.avatar});case 11:f=e.sent,g=[d.width,d.height],m=[x.width,x.height],[l,p],v=n-2*r,g[0]!=v&&(g[1]=Math.floor(v/g[0]*g[1]),g[0]=v),m[0]!=u&&(m[1]=Math.floor(u/m[0]*m[1]),m[0]=u),a.canvasW=n,a.canvasH=i,a.ctx.setFillStyle(a.CanvasBg),a.ctx.fillRect(0,0,n,a.canvasH),a.ctx.drawImage(d.path,0,0,n,i),h=uni.upx2px(62),a.ctx.setFillStyle("#FFFFFF"),a.ctx.setStrokeStyle("#FFFFFF"),a.ctx.lineJoin="round",a.ctx.lineWidth=5,a.ctx.setShadow(0,0,20,"rgba(0,0,0,0.05)"),a.ctx.strokeRect(r,h,c,o),a.ctx.fillRect(r,h,c,o),h+=uni.upx2px(30),a.ctx.save(),a.ctx.beginPath(),a.ctx.arc(n/2,h+s/2,s/2,0,2*Math.PI),a.ctx.clip(),a.ctx.drawImage(f.path,n/2-s/2,h,s,s),a.ctx.restore(),h+=s,h+=uni.upx2px(60),a.ctx.setFontSize(uni.upx2px(40)),a.ctx.setFillStyle("#333333"),a.ctx.setTextAlign("center"),a.ctx.fillText(a.userName,n/2,h),h+=uni.upx2px(40),a.ctx.setFontSize(uni.upx2px(28)),a.ctx.setFillStyle("#9B9B9B"),a.ctx.setTextAlign("center"),a.ctx.fillText(a.company,n/2,h),h+=uni.upx2px(20),b=uni.upx2px(98),w=uni.upx2px(34),a.ctx.setFillStyle("rgba(135,74,152,0.1)"),a.ctx.lineJoin="round",a.ctx.fillRect(n/2-b/2,h,b,w),h+=uni.upx2px(25),a.ctx.setFontSize(uni.upx2px(24)),a.ctx.setFillStyle("#874A98"),a.ctx.setTextAlign("center"),a.ctx.fillText(a.postName,n/2,h),h+=uni.upx2px(60),a.ctx.setFontSize(uni.upx2px(2)),a.ctx.lineWidth=1,a.ctx.moveTo(uni.upx2px(90),h),a.ctx.lineTo(uni.upx2px(500),h),a.ctx.strokeStyle="#F6F6F6",a.ctx.stroke(),h+=uni.upx2px(60),a.ctx.setFontSize(uni.upx2px(28)),a.ctx.setFillStyle("#9B9B9B"),a.ctx.fillText("服务年限",uni.upx2px(180),h),a.ctx.fillText("带看人数",uni.upx2px(410),h),h+=uni.upx2px(60),a.ctx.setFontSize(uni.upx2px(34)),a.ctx.setFillStyle("#333333"),a.ctx.setTextAlign("center"),a.ctx.fillText(a.years,uni.upx2px(180),h),a.ctx.fillText(a.visitTimes,uni.upx2px(410),h),h+=uni.upx2px(40),a.ctx.setFontSize(uni.upx2px(2)),a.ctx.lineWidth=1,a.ctx.moveTo(uni.upx2px(90),h),a.ctx.lineTo(uni.upx2px(500),h),a.ctx.strokeStyle="#F6F6F6",a.ctx.stroke(),h+=uni.upx2px(60),a.ctx.setFontSize(uni.upx2px(28)),a.ctx.setFillStyle("#9B9B9B"),a.ctx.setTextAlign("center"),a.ctx.fillText("长按识别二维码，海量房源任你选",n/2,h),h+=uni.upx2px(60),a.ctx.drawImage(x.path,n/2-u/2,h,m[0],m[1]),setTimeout((function(){a.ctx.draw(!0,(function(t){a.getNewImage()}))}),600);case 93:case"end":return e.stop()}}),e)})))()},getImageInfo:function(t){return(0,r.default)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.imgSrc,e.abrupt("return",new Promise((function(t,e){uni.getImageInfo({src:n,success:function(e){console.log(n,e),t(e)},fail:function(t){console.log(n,t),e(t)}})})));case 2:case"end":return e.stop()}}),e)})))()},getNewImage:function(){uni.canvasToTempFilePath({canvasId:a.CanvasID,quality:1,complete:function(t){a.$emit("success",t)}},this)}},mounted:function(){a=this,setTimeout((function(){a.OnCanvas()}),1e3)}};e.default=c},"2b31":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAFNQDtUAAAABGdBTUEAALGPC/xhBQAAAs5JREFUWAnlV8tqFUEQvTcYEnDhwqwUHwiaQNwKfoUf4MaFYBbuDBgRMRCzCiTkB0TQhXtd+QW+P0ECbt1oElEwD8/p6Zqu7qnumcn1QsCCSlfXqXf3zNwMBiU6BAk+pBAphkOncwYaEI8OK91INJ1o2AtCAPJOwyDkryxCsaq2ZtxGHJ8cOWYNjLkvU69HsGsYnkTWTtmCL1v09Fa0rSFyBnX7LhLC3pfYaj0QcAbKqcTIgdDNsecV8FVae6PKs9ofnsDKebwHKMBPyM1DgpFJ0eFpC0RZxT7uZjD4gOm+1nZFGUEsqoesnXPz1DbdZaS9a6Uu6bLR4bRUcgQm049jAHjiHd0ZEsU+vRGRM/Bd+tBWZiKnsE8lCaewBubpLXAFia3D8Ud8qj0CXmLUI9AXiTjyal42VHQDka8l0dnSo0SX3yLIO6u1nEc6rJxdUX/8g8R3oNiMAq1BtujuKPcgtjhp+F7wMiRtmZEXDTf3sM3B4YqAGWeqXQVYJ8Gz4NPiwyeW9KdWQKhU0d+6AmjPe2SZPvqeRCfCO66CLmK7rvYiOh++6rPEQMh4G8vTxGhP73UQ9rmjQZGh3xTZr9JBqBZGW+Cj0MUk+P+2xcw+95jbpz7zkYPq6hPd6RanPrbRnW+JO16470TGVs2xKSQ8xL5XXMZbEG8arfPVcx18ysAs1Q8oP1oAdM/xdnqRwYIaxaQ/j3o8LEXTA6Dl70woI0hwavvxV8yagP0LCKVU0ggF9Z8Akj0G/wb/Am+D542Cuh6ZWQBingN/AzMHcz2UHPqp4ddrCjztuXGRccHkV/GSBEhWXmh+ZyfAGwnGLWNKfOaqv5i6EBp2IlXQA+VQKkCZ2WJdUQKz8jMY3TbWxmSU7UvIz7zNNOwvKCwVOa2z3jbFwmiA6B8SLPBNw/rfK9ioo6hb3xH/peBLix2Mg5jzO/gVjvjrOBKMFPMvPRwn2hY7t7QAAAAASUVORK5CYII="},3030:function(t,e,n){"use strict";n.r(e);var i=n("c6ec"),a=n("3e27");for(var r in a)"default"!==r&&function(t){n.d(e,t,(function(){return a[t]}))}(r);var c,o=n("f0c5"),u=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,"05d2da92",null,!1,i["a"],c);e["default"]=u.exports},"3e27":function(t,e,n){"use strict";n.r(e);var i=n("2233"),a=n.n(i);for(var r in i)"default"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);e["default"]=a.a},"53cf":function(t,e,n){"use strict";n.r(e);var i=n("89f4"),a=n("7a89");for(var r in a)"default"!==r&&function(t){n.d(e,t,(function(){return a[t]}))}(r);n("fa7d");var c,o=n("f0c5"),u=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,"8d7bc206",null,!1,i["a"],c);e["default"]=u.exports},"7a89":function(t,e,n){"use strict";n.r(e);var i=n("810e"),a=n.n(i);for(var r in i)"default"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);e["default"]=a.a},"810e":function(t,e,n){"use strict";var i=n("ee27");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("96cf");var a=i(n("c964")),r=i(n("3030")),c=i(n("d66d")),o={name:"myCard",components:{card:r.default},data:function(){return{avatar:"",userName:"",company:"",postName:"",years:"",visitTimes:"",qrCode:"",page:"pages/home/home",scene:"",width:"590",height:"1048",img:"https://img.bajiaostar.com/FjLlW0Jl5OuvhnYcNSR2hCuMecCL",show:!1,poster:"",path:""}},methods:{getQrCode:function(){var t=this;return(0,a.default)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$fetch(t.$api.getQrcodePic,{data:t.scene,page:t.page},"GET");case 2:n=e.sent,console.log(n),t.qrCode="https://admin.homeyb.cn"+n.data;case 5:case"end":return e.stop()}}),e)})))()},getUserInfo:function(){var t=this;return(0,a.default)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$fetch(t.$api.getInfo,{},"GET");case 2:n=e.sent,n.data.avatar?t.avatar=c.default.pro+"profile/avatar/"+n.data.avatar:t.avatar="https://img.bajiaostar.com/FgkVAFlA5etvApeTeLEt2P0s822H",console.log(t.avatar),t.userName=n.data.userName,t.company=n.data.company,t.postName=n.data.postName,n.data.years?t.years=n.data.years:t.years="0",n.data.visitTimes?t.visitTimes=n.data.visitTimes:t.visitTimes="0";case 10:case"end":return e.stop()}}),e)})))()},getImage:function(t){uni.hideLoading(),this.poster=t.tempFilePath,this.show=!0},download:function(){var t=this.poster;uni.authorize({scope:"scope.writePhotosAlbum",success:function(){uni.saveImageToPhotosAlbum({filePath:t,success:function(){uni.showToast({icon:"none",title:"图片已经保存到您的手机相册"})},fail:function(){uni.showToast({icon:"none",title:"保存失败"})}})},fail:function(){uni.showModal({title:"授权提醒",content:"请您先开启您的相册权限",success:function(t){t.confirm&&uni.openSetting({})}})}})}},onLoad:function(t){this.scene=t.id,uni.showLoading({title:"生成名片中"}),this.getUserInfo(),this.getQrCode()},onShareAppMessage:function(t){return this.path="pages/home/home?id="+this.scene,t.from,{title:"我的名片",path:this.path,imageUrl:this.poster}}};e.default=o},"89f4":function(t,e,n){"use strict";var i={getApp:n("1bde").default},a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"container"},[i("v-uni-view",{staticClass:"content"},[i("card",{attrs:{QrSrc:t.qrCode,avatar:t.avatar,userName:t.userName,Width:t.width,Height:t.height,company:t.company,postName:t.postName,years:t.years,visitTimes:t.visitTimes,imgSrc:t.img},on:{success:function(e){arguments[0]=e=t.$handleEvent(e),t.getImage.apply(void 0,arguments)}}})],1),t.show?i("v-uni-view",{staticClass:"bottom"},[i("v-uni-view",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.download.apply(void 0,arguments)}}},[i("v-uni-image",{attrs:{src:n("2b31"),mode:""}}),i("v-uni-text",[t._v("保存")])],1),i("v-uni-view",[i("v-uni-button",{attrs:{"open-type":"share"}},[i("v-uni-image",{attrs:{src:n("e1d7"),mode:""}}),i("v-uni-text",[t._v("分享")])],1)],1)],1):t._e(),i("getApp")],1)},r=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return i}))},a5b8:function(t,e,n){var i=n("b80a");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=n("4f06").default;a("4df60fb4",i,!0,{sourceMap:!1,shadowMode:!1})},b80a:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".content[data-v-8d7bc206]{width:%?590?%;height:%?1048?%;margin:%?30?% %?80?% 0 %?80?%;border-radius:%?10?%}.bottom[data-v-8d7bc206]{width:%?750?%;height:%?100?%;position:fixed;display:-webkit-box;display:-webkit-flex;display:flex;bottom:0}.bottom > uni-view[data-v-8d7bc206]:first-child{-webkit-box-flex:1;-webkit-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;color:#fff;font-size:%?28?%;background-image:-webkit-linear-gradient(45deg,#ffbf2f,#ff9417);background-image:linear-gradient(45deg,#ffbf2f,#ff9417)}.bottom > uni-view:first-child uni-image[data-v-8d7bc206]{width:%?34?%;height:%?34?%}.bottom > uni-view:first-child uni-text[data-v-8d7bc206]{margin-left:%?20?%}.bottom > uni-view[data-v-8d7bc206]:last-child{-webkit-box-flex:1;-webkit-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:flex;background-image:-webkit-linear-gradient(45deg,#ac63c0,#874a98);background-image:linear-gradient(45deg,#ac63c0,#874a98)}.bottom > uni-view:last-child uni-button[data-v-8d7bc206]{-webkit-box-flex:1;-webkit-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;color:#fff;font-size:%?28?%;background-image:-webkit-linear-gradient(45deg,#ac63c0,#874a98);background-image:linear-gradient(45deg,#ac63c0,#874a98)}.bottom > uni-view:last-child uni-button uni-image[data-v-8d7bc206]{width:%?34?%;height:%?34?%}.bottom > uni-view:last-child uni-button uni-text[data-v-8d7bc206]{margin-left:%?20?%}",""]),t.exports=e},c6ec:function(t,e,n){"use strict";var i,a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("v-uni-canvas",{staticStyle:{"border-radius":"10px"},style:{width:t.canvasW+"px",height:t.canvasH+"px"},attrs:{"canvas-id":t.CanvasID}})],1)},r=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return i}))},e1d7:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAFNQDtUAAAABGdBTUEAALGPC/xhBQAAA0VJREFUWAnFl0loFEEUhjNGkkAgSpRgwBUEvajgwRjwEPAYUYKneFIEgyA5RfQm4t2TXlwglyAiqOBJEXFHxIMXEUFxww1j3DCJBjN+r6deTU119ZJ0Bh/8/V695X9V1V09PQ0NjpTL5UXOsGLiLFtnzcB6jUHwrJjzvMCoN/aGlJ2LeOWCXNR4SQ2cr7FHLXGpVFqBY0wTajTZg8Ij4gdOiiMW0KyopHJ5pL5cWgtTk0laKQl2WW62MJjxS7tMN8Gxv0Y2BUdBMzgA2sWJbtRgH4NIIkfoogno7OWSdFVIpChEFvmIvZIEkbSkycRgUgDCDxFt9TI/KTfop+5WtbZqSXLWhsuim4BM+y64L0VGJngWa+9oldta77GGtSJTk9xrS6vGpczCUAL1e8CQxrC7Dec29RXSkK02hK56K6SZG6ud2cPn2Ad1bPRvb5xvyDTWgspJyFdSzaJwi7sO7NMarb3P6g1oIQi421jmz9x7EiAQ1+YEf9zNJFplJgFpjmcHPBQeNsUbPJLBWDoJG8EI2ClB9DzwA5xwkxm3uGNrExgCrjwzgyU2KcWI7o4U+DmxE+onOOOidyeiUpLdDrGYd8xyejx/+pCipeAY6NJM7HvgqY5nrSFZD0T6QQf4Av6AvhmTUnQB+BL/pkhjpjr01O5LqwnG/GkwXhBMTHNS1AbkV+0b6EnLnZMYTdaAYfAOTAI5Qg/BXqCP1pz0CpLQZDF4AbIk/hIIMs7SSffLWTMw8Wn0Jm1Tjy2qfHJph2Q9TWjmHzfJfJUIq+sCD8xqfxmdpGQ3dmRx5o5Dtg7cMN2eoLdqMbacVfn+vA7kdf0YnAL2dmhuTJMkPxDyXpsAvtzEsQysAldMUB7K7TGiIg4IO8Fn0yBNfSS4q0iv1FrIB9K6O7HbqURFgzRqB2+chkmmPIhHQGvRnm69Pb78bI+B5QQHwCc3CfsvGAELQQdoAt/NTI+joz9E+P6PMIEWcAjocT2D3enPBp/8uHcDOWWyiPoJDRrBfjAKRM4Dfa9EDucyhd1fv9kYZprIpOS9kiX26NtnpA6zG8/BOZUjp1gKWyFv1msJWyLPVK/bIfdfE7dopjZN5QtKvsbHOZnRXzyf4x9SmHA05o+U6wAAAABJRU5ErkJggg=="},fa7d:function(t,e,n){"use strict";var i=n("a5b8"),a=n.n(i);a.a}}]);
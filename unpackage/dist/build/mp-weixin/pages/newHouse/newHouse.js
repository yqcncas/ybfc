(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/newHouse/newHouse"],{"0099":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(n("4795")),a=s(n("d66d"));function s(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,o,a,s,i){try{var r=e[s](i),u=r.value}catch(c){return void n(c)}r.done?t(u):Promise.resolve(u).then(o,a)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var s=e.apply(t,n);function r(e){i(s,o,a,r,u,"next",e)}function u(e){i(s,o,a,r,u,"throw",e)}r(void 0)}))}}var u=function(){n.e("components/uni-swiper-dot/uni-swiper-dot").then(function(){return resolve(n("8735"))}.bind(null,n)).catch(n.oe)},c=function(){n.e("components/Guess/Guess").then(function(){return resolve(n("5fd6"))}.bind(null,n)).catch(n.oe)},h=function(){n.e("components/uni-grid/uni-grid").then(function(){return resolve(n("7954"))}.bind(null,n)).catch(n.oe)},l=function(){Promise.all([n.e("common/vendor"),n.e("components/Modal/loginModal")]).then(function(){return resolve(n("b83e"))}.bind(null,n)).catch(n.oe)},d=function(){Promise.all([n.e("common/vendor"),n.e("components/jyf-Parser/index")]).then(function(){return resolve(n("1221"))}.bind(null,n)).catch(n.oe)},f={name:"newHouse",components:{uniSwiperDot:u,Guess:c,uniGrid:h,loginModal:l,parser:d},data:function(){return{houseId:"",height:64,top:0,scrollH:0,opcity:0,iconOpcity:.5,current:0,mode:"nav",dotsStyles:{backgroundColor:"rgba(0, 0, 0, .3)",border:"1px rgba(0, 0, 0, .3) solid",color:"#fff",selectedBackgroundColor:"rgba(0, 0, 0, .9)",selectedBorder:"1px rgba(0, 0, 0, .9) solid"},autoplay:!1,interval:3e3,circular:!0,swiperList:[],isVideo:"",videoPic:"",isImg:"",islayOut:"",length:"",houseType:"",houseInfo:[],isCollect:0,houseTypeList:[],mobile:"",postName:"",userId:"",avatar:"",userName:"",company:"",homeList:[],isToken:!1,manager:"",loadShow:!1,backHome:!1,isAdmin:!1,modalShow:!1,flag:!1,path:"",shareTitle:"",shareUserId:"",favoritesShow:!1,isEmpty:!1,favoritesList:[],chooseFavorites:"",favoritesName:"",addShow:!1,userMobile:"",verCode:"",count:60,verificationFlag:!1,from:"",clientName:"",shareImg:"https://img.bajiaostar.com/2e0268c4601672d79e140d888a1f9e40",share:""}},methods:{back:function(){this.backHome?e.switchTab({url:"../home/home"}):e.navigateBack({delta:1})},change:function(e){this.current=e.detail.current},getHouseInfo:function(){var t=this;return r(o.default.mark((function n(){var s,i,r,u;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.swiperList=[],n.next=3,t.$fetch(t.$api.areaInfo,{areaId:t.houseId},"GET");case 3:s=n.sent,t.isCollect=s.data.collect,s.data.newArea.movieUrl?(t.videoPic=s.data.newArea.movieFirst,t.swiperList.push(s.data.newArea.movieUrl),t.isVideo=!0):t.isVideo=!1,s.data.newArea.picUrl?(i=s.data.newArea.picUrl.split(","),i[0]&&(t.shareImg=i[0],console.log(t.shareImg)),i.forEach((function(e){t.swiperList.push(e)})),t.isImg=!0):t.isImg=!1,s.data.newArea.layoutPic?(r=s.data.newArea.layoutPic.split(","),r.forEach((function(e){t.swiperList.push(e)})),t.islayOut=!0):t.islayOut=!1,t.length=t.swiperList.length,t.length||(t.swiperList[0]="https://img.bajiaostar.com/FnwyfqiIK3_RD5UR1k66KQ_y0VFx"),t.houseInfo=s.data.newArea,t.houseInfo.label&&(t.houseInfo.label=t.houseInfo.label.split(",")),t.shareTitle=s.data.newArea.areaName,t.isAdmin?t.path="pages/newHouse/newHouse?houseId="+t.houseId+"&houseType="+t.houseType+"&userId="+t.shareUserId+"&share=1":t.path="pages/newHouse/newHouse?houseId="+t.houseId+"&houseType="+t.houseType+"&share=1",t.houseInfo.publish=t.$dayjs(t.houseInfo.publish).format("YYYY年MM月"),s.data.newHouseList.forEach((function(e){e.status||(e.status="3"),e.houseName||(e.houseName=""),e.acreage||(e.acreage="")})),t.houseTypeList=s.data.newHouseList,u=s.data.manager,t.manager||(t.avatar=a.default.pro+"profile/avatar/"+u.avatar,t.userName=u.userName,t.company=u.company,t.mobile=u.phonenumber,t.postName=u.postName,t.userId=u.userId),s.data.guess.forEach((function(e){e.picUrl?e.picUrl=e.picUrl.split(","):e.picUrl="https://img.bajiaostar.com/FnwyfqiIK3_RD5UR1k66KQ_y0VFx".split(","),e.label&&(e.label=e.label.split(","))})),t.homeList=s.data.guess,t.loadShow=!0,e.hideLoading();case 23:case"end":return n.stop()}}),n)})))()},handleToShowFavorites:function(){var t=this;return r(o.default.mark((function n(){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$fetch(t.$api.favoriteList,{},"GET");case 2:a=n.sent,console.log(a),0==a.code?(a.data.length>0?t.isEmpty=!1:t.isEmpty=!0,t.favoritesList=a.data,t.favoritesShow=!0):401==a.code&&(e.showToast({icon:"none",title:a.msg}),setTimeout((function(){e.navigateTo({url:"../login/login"})}),1e3));case 5:case"end":return n.stop()}}),n)})))()},handleCloseFavor:function(){this.favoritesShow=!1,this.chooseFavorites=""},handleChoose:function(e){this.chooseFavorites=e},handleShowAddFavorites:function(){this.favoritesShow=!1,this.addShow=!0},handleCloseAdd:function(){this.addShow=!1,this.favoritesShow=!0},handleAddFavor:function(){var t=this;return r(o.default.mark((function n(){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$fetch(t.$api.addFavorite,{name:t.favoritesName},"GET");case 2:a=n.sent,console.log(a),e.showToast({icon:"none",title:a.msg}),0==a.code&&(t.addShow=!1,t.favoritesName="",t.handleToShowFavorites());case 6:case"end":return n.stop()}}),n)})))()},collect:function(){var t=this;return r(o.default.mark((function n(){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.chooseFavorites){n.next=2;break}return n.abrupt("return",e.showToast({icon:"none",title:"请选择收藏夹"}));case 2:return n.next=4,t.$fetch(t.$api.collect,{houseId:t.houseId,houseType:t.houseType,favoriteId:t.chooseFavorites},"GET");case 4:a=n.sent,0==a.code&&(t.isCollect=1,t.favoritesShow=!1,t.chooseFavorites=""),e.showToast({icon:"none",title:a.msg});case 7:case"end":return n.stop()}}),n)})))()},goVideo:function(){this.current=0},goImg:function(){this.isVideo?this.current=1:this.current=0},goLayOut:function(){this.current=this.length-1},videoPlay:function(){var t=e.createVideoContext("houseVideo");t.requestFullScreen({direction:90})},callTel:function(){var t=this;e.showModal({title:"拨打电话",content:"拨打经纪人号码:"+this.mobile,success:function(n){n.confirm&&e.makePhoneCall({phoneNumber:t.mobile})}})},checkMoreInfo:function(){e.navigateTo({url:"moreInfo?houseId="+this.houseId+"&houseType=3"})},checkApartment:function(t){this.manager?e.navigateTo({url:"apartment?id="+t+"&flag=1&userId="+this.manager}):e.navigateTo({url:"apartment?id="+t})},checkAgent:function(t){e.navigateTo({url:"../agent/agentDetail?id="+t})},goShare:function(){this.isToken?e.navigateTo({url:"../share/newShare?id="+this.houseId+"&houseType="+this.houseType}):(e.showToast({icon:"none",title:"请先登录！"}),setTimeout((function(){e.navigateTo({url:"../login/login"})}),1e3))},getManagerInfo:function(){var e=this;return r(o.default.mark((function t(){var n,s;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$fetch(e.$api.getAgentInfo,{userId:e.manager},"GET");case 2:n=t.sent,s=n.data.user,e.avatar=a.default.pro+"profile/avatar/"+s.avatar,e.userName=s.userName,e.company=s.company,e.mobile=s.phonenumber,e.postName=s.postName,e.userId=s.userId;case 10:case"end":return t.stop()}}),t)})))()},modalClose:function(e){this.modalShow=e},getToken:function(t){e.setStorageSync("token",t),e.setStorageSync("isAdmin",!1),e.setStorageSync("isToken",!0),this.isToken=!0},viewImage:function(t){e.previewImage({urls:this.swiperList,current:t,loop:!0})},addH5Browse:function(){var e=this;return r(o.default.mark((function t(){var n;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$fetch(e.$api.addH5Browse,{clientName:e.clientName,houseId:e.houseId,houseType:e.houseType,manager:e.manager},"GET");case 2:n=t.sent,console.log(n);case 4:case"end":return t.stop()}}),t)})))()},handleToAuthorize:function(){e.setStorageSync("shareHouseId",this.houseId),e.setStorageSync("shareHouseType",this.houseType),e.setStorageSync("shareManager",this.manager),this.share&&e.setStorageSync("shareFrom",this.share),window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=".concat(this.$api.appid,"&redirect_uri=").concat(this.$api.redirectUrl,"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirec")},getSDKSign:function(){var e=this;return r(o.default.mark((function t(){var n,a,s,i,r,u,c,h;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=location.href,t.next=3,e.$fetch(e.$api.getSDKSign,{url:n},"POST","form");case 3:a=t.sent,s=a.data.noncestr,i=a.data.timestamp,r=a.data.sign,console.log(e.houseInfo.areaName),u=e.houseInfo.areaName,c=e.shareImg,h=location.href+"&shareFlag=1",jwx.config({appId:e.$api.appid,timestamp:i,nonceStr:s,signature:r,jsApiList:["updateAppMessageShareData","updateTimelineShareData"]}),jwx.ready((function(){jwx.updateAppMessageShareData({title:u,desc:"温州英棒房产，为您提供真实，有效，准确真房源!",link:h,imgUrl:c,success:function(){console.log("成功设置分享到微信")}}),jwx.updateTimelineShareData({title:u,link:h,imgUrl:c,success:function(){console.log("成功设置分享到朋友圈")}})}));case 13:case"end":return t.stop()}}),t)})))()},handleToRefuse:function(){var t=this;e.showModal({title:"提醒",content:"你确定要取消授权吗？",success:function(e){e.confirm&&(t.modalShow=!1)}})}},onLoad:function(t){var n=this;e.showLoading({title:"加载中"});var o={};if(o=wx.getMenuButtonBoundingClientRect(),e.getSystemInfo({success:function(e){n.width=o.left||e.windowWidth,n.height=o.top?o.top+o.height+8:e.statusBarHeight+44,n.top=o.top?o.top+(o.height-32)/2:e.statusBarHeight+6,n.scrollH=e.windowWidth}}),t.scene){this.backHome=!0;var a=decodeURIComponent(t.scene);this.houseId=a.split("&")[0],this.houseType=a.split("&")[1],a.split("&")[2]&&(this.manager=a.split("&")[2],e.setStorageSync("manager",this.manager))}else this.houseId=t.houseId,this.houseType=t.houseType,t.userId&&(this.manager=t.userId,e.setStorageSync("manager",this.manager)),t.share?this.backHome=!0:this.backHome=!1,t.flag?this.flag=!0:this.flag=!1},onShow:function(){var t=this;e.getStorageSync("isAdmin")&&(this.isAdmin=e.getStorageSync("isAdmin"),this.shareUserId=e.getStorageSync("userId")),e.getStorageSync("isToken")&&(this.isToken=e.getStorageSync("isToken")),e.getStorageSync("manager")&&(this.manager=e.getStorageSync("manager")),this.getHouseInfo(),(this.backHome||this.flag)&&(this.isToken?this.manager&&this.getManagerInfo():this.manager&&(this.getManagerInfo(),setTimeout((function(){t.modalShow=!0}),1e3)))},onPageScroll:function(e){var t=e.scrollTop<=0?0:e.scrollTop,n=t/this.scrollH;this.opcity>=1&&n>=1||(this.opcity=n,this.iconOpcity=.5*(1-n<0?0:1-n))},onShareAppMessage:function(e){return e.from,{title:this.shareTitle,path:this.path}}};t.default=f}).call(this,n("543d")["default"])},"1c0c":function(e,t,n){"use strict";n.r(t);var o=n("0099"),a=n.n(o);for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t["default"]=a.a},"464e":function(e,t,n){"use strict";var o=n("c254"),a=n.n(o);a.a},"977d":function(e,t,n){"use strict";var o={uniSwiperDot:function(){return n.e("components/uni-swiper-dot/uni-swiper-dot").then(n.bind(null,"8735"))},Guess:function(){return n.e("components/Guess/Guess").then(n.bind(null,"5fd6"))},uPopup:function(){return n.e("node-modules/uview-ui/components/u-popup/u-popup").then(n.bind(null,"6b9d"))},uEmpty:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-empty/u-empty")]).then(n.bind(null,"e7e0"))}},a=function(){var e=this,t=e.$createElement;e._self._c},s=[];n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o}))},"991d":function(e,t,n){"use strict";n.r(t);var o=n("977d"),a=n("1c0c");for(var s in a)"default"!==s&&function(e){n.d(t,e,(function(){return a[e]}))}(s);n("464e");var i,r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],i);t["default"]=u.exports},b6b1:function(e,t,n){"use strict";(function(e){n("ceaf");o(n("66fd"));var t=o(n("991d"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},c254:function(e,t,n){}},[["b6b1","common/runtime","common/vendor"]]]);
(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mapSearch/mapSearch"],{"09e2":function(e,t,a){"use strict";var i,n=function(){var e=this,t=e.$createElement;e._self._c},r=[];a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return i}))},"3efd":function(e,t,a){"use strict";(function(e){a("ceaf");i(a("66fd"));var t=i(a("46e4"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("543d")["createPage"])},"46e4":function(e,t,a){"use strict";a.r(t);var i=a("09e2"),n=a("a601");for(var r in n)"default"!==r&&function(e){a.d(t,e,(function(){return n[e]}))}(r);a("6311");var s,o=a("f0c5"),l=Object(o["a"])(n["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=l.exports},6311:function(e,t,a){"use strict";var i=a("b3dd"),n=a.n(i);n.a},a601:function(e,t,a){"use strict";a.r(t);var i=a("ac64"),n=a.n(i);for(var r in i)"default"!==r&&function(e){a.d(t,e,(function(){return i[e]}))}(r);t["default"]=n.a},ac64:function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("4795"));function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t,a,i,n,r,s){try{var o=e[r](s),l=o.value}catch(c){return void a(c)}o.done?t(l):Promise.resolve(l).then(i,n)}function s(e){return function(){var t=this,a=arguments;return new Promise((function(i,n){var s=e.apply(t,a);function o(e){r(s,i,n,o,l,"next",e)}function l(e){r(s,i,n,o,l,"throw",e)}o(void 0)}))}}var o={name:"mapSearch",data:function(){return{lat:27.992827,lng:120.649701,scale:11,tabCurrentIndex:0,tabList:[{id:1,name:"二手房"},{id:2,name:"租房"},{id:3,name:"新房"}],houseType:2,markers:[],size:1,oldHouseList:[],newHosueList:[],flag1:!0,flag2:!0,flag3:!0,flag4:!0,markers1:[],markers2:[],markers3:[],markers4:[],circles:[],isUpdate:!1,labelList:[],label1:[],label2:[],label3:[],label4:[],drag:!1}},methods:{bMapToTxMap:function(e,t){var a=new Object,i=52.35987755982988,n=t-.0065,r=e-.006,s=Math.sqrt(n*n+r*r)-2e-5*Math.sin(r*i),o=Math.atan2(r,n)-3e-6*Math.cos(n*i),l=s*Math.cos(o),c=s*Math.sin(o);return a.longitude=l,a.latitude=c,a},changeTab:function(e){this.tabCurrentIndex=e,this.flag1=!0,this.flag2=!0,this.flag3=!0,this.flag4=!0,this.scale=11,0==this.tabCurrentIndex?(this.markers=[],this.houseType=2,this.searchHouse(),this.searchxyProvince(),this.searchxyHouse(this.lat,this.lng),this.markers=this.markers1):1==this.tabCurrentIndex?(this.markers=[],this.houseType=1,this.searchHouse(),this.searchxyProvince(),this.searchxyHouse(this.lat,this.lng),this.markers=this.markers1):2==this.tabCurrentIndex&&(this.markers=[],this.houseType=3,this.searchNewHouse(),this.searchNewxyProvince(),this.searchNewxyHouse(this.lat,this.lng),this.markers=this.markers1)},clickLabel:function(t){var a=this;console.log(t);var i=t.markerId;this.scale>=17?3!=this.houseType?e.navigateTo({url:"../xiaoqu/areaHouse?areaId="+i+"&houseType="+this.houseType}):e.navigateTo({url:"../newHouse/newHouse?houseId="+i+"&houseType="+this.houseType}):this.scale<=12?(this.markers=[],this.markers1.forEach((function(e){e.id==i&&(a.lat=e.latitude,a.lng=e.longitude)})),this.isUpdate=!0,this.scale=13):this.scale>=13&&this.scale<=14&&(this.markers=[],this.isUpdate=!0,this.scale=17,this.markers2.forEach((function(e){e.id==i&&(a.lat=e.latitude,a.lng=e.longitude)})))},changeRegion:function(t){var a=this;console.log(t),this.mapCtx=e.createMapContext("mapSearch"),console.log(this.mapCtx),this.mapCtx.getCenterLocation({success:function(e){console.log(e),a.lat=e.latitude,a.lng=e.longitude}}),this.mapCtx.getScale({success:function(e){console.log(e.scale)}}),this.isUpdate?this.scale>=13&&this.scale<=14&&this.flag2?(this.markers=[],this.flag1=!0,this.flag2=!1,this.flag3=!0,this.flag4=!0,this.isUpdate=!1,this.markers=this.markers2):this.scale>=17&&this.flag4&&(this.markers=[],this.flag1=!0,this.flag2=!0,this.flag3=!0,this.flag4=!1,this.isUpdate=!1,this.markers=this.markers4):"scale"==t.causedBy&&this.mapCtx.getScale({success:function(e){console.log(e.scale),e.scale<13&&a.flag1?(a.markers=[],a.flag1=!1,a.flag2=!0,a.flag3=!0,a.flag4=!0,a.markers=a.markers1,a.scale=e.scale):e.scale>=13&&a.flag2&&e.scale<=14?(a.markers=[],a.flag1=!0,a.flag2=!1,a.flag3=!0,a.flag4=!0,a.markers=a.markers2,a.scale=e.scale):e.scale>=15&&a.flag3&&e.scale<=16?(a.markers=[],a.flag1=!0,a.flag2=!0,a.flag3=!1,a.flag4=!0,a.markers=a.markers3,a.scale=e.scale):e.scale>=17&&a.flag4&&(a.markers=[],a.flag1=!0,a.flag2=!0,a.flag3=!0,a.flag4=!1,a.markers=a.markers4,a.scale=e.scale)}})},searchHouse:function(){var e=this;return s(i.default.mark((function t(){var a,n,r;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.markers1=[],t.next=3,e.$fetch(e.$api.jiufang,{houseType:e.houseType},"GET");case 3:for(r in a=t.sent,n=a.data,n.forEach((function(t){var a=new Object;a=e.bMapToTxMap(t.latitude,t.longitude),t.latitude=a.latitude,t.longitude=a.longitude})),n)e.markers1.push({id:r+1,latitude:n[r]["latitude"],longitude:n[r]["longitude"],alpha:1,width:5,height:5,iconPath:"../../static/icon/5.png",label:{content:n[r]["dictValue"]+"\n"+n[r]["count"],fontSize:12,anchorX:-30,anchorY:-30,bgColor:"#874A98BB",padding:10,textAlign:"center",color:"#FFFFFF",borderRadius:99999}});case 7:case"end":return t.stop()}}),t)})))()},searchxyProvince:function(){var e=this;return s(i.default.mark((function t(){var a,n,r;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.markers2=[],t.next=3,e.$fetch(e.$api.jiufangProvince,{houseType:e.houseType},"GET");case 3:for(r in a=t.sent,e.oldHouseList=JSON.parse(JSON.stringify(a.data)),n=a.data,n.forEach((function(t){var a=new Object;a=e.bMapToTxMap(t.latitude,t.longitude),t.latitude=a.latitude,t.longitude=a.longitude})),n)"下吕浦"!=n[r]["dictValue"]&&e.markers2.push({id:r+1,latitude:n[r]["latitude"],longitude:n[r]["longitude"],alpha:1,width:5,height:5,iconPath:"../../static/icon/5.png",label:{content:n[r]["dictValue"]+"\n"+n[r]["count"],fontSize:12,anchorX:-30,anchorY:-30,bgColor:"#874A98BB",padding:10,textAlign:"center",color:"#FFFFFF",borderRadius:99999}});for(r in n)"下吕浦"==n[r]["dictValue"]&&e.markers2.push({id:r+1,latitude:n[r]["latitude"],longitude:n[r]["longitude"],alpha:1,width:5,height:5,iconPath:"../../static/icon/5.png",label:{content:n[r]["dictValue"]+"\n"+n[r]["count"],fontSize:12,anchorX:-30,anchorY:-30,bgColor:"#FE9E2E",padding:10,textAlign:"center",color:"#FFFFFF",borderRadius:99999}});case 9:case"end":return t.stop()}}),t)})))()},searchxyHouse:function(e,t){var a=this;return s(i.default.mark((function n(){var r,s,o;return i.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return a.markers3=[],a.markers4=[],i.next=4,a.$fetch(a.$api.jiufangHouse,{lat:e,lng:t,size:20,houseType:a.houseType},"GET");case 4:for(o in r=i.sent,s=r.data,s.forEach((function(e){var t=new Object;t=a.bMapToTxMap(e.latitude,e.longitude),e.latitude=t.latitude,e.longitude=t.longitude})),s)a.markers4.push({id:s[o]["areaId"],latitude:s[o]["latitude"],longitude:s[o]["longitude"],alpha:1,width:5,height:5,iconPath:"../../static/icon/5.png",label:{content:s[o]["areaName"]+"|"+s[o]["count"]+"套",fontSize:14,anchorX:-40,anchorY:-40,bgColor:"#874A98",padding:5,textAlign:"center",color:"#FFFFFF",borderRadius:20}}),a.markers3.push({id:s[o]["areaId"],latitude:s[o]["latitude"],longitude:s[o]["longitude"],alpha:1,width:25,height:19,iconPath:"../../static/icon/222.png"});case 8:case"end":return i.stop()}}),n)})))()},searchNewHouse:function(){var e=this;return s(i.default.mark((function t(){var a,n,r;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.markers1=[],t.next=3,e.$fetch(e.$api.xinfang,{},"GET");case 3:for(r in a=t.sent,n=a.data,n.forEach((function(t){var a=new Object;a=e.bMapToTxMap(t.latitude,t.longitude),t.latitude=a.latitude,t.longitude=a.longitude})),n)e.markers1.push({id:r+1,latitude:n[r]["latitude"],longitude:n[r]["longitude"],alpha:1,width:5,height:5,iconPath:"../../static/icon/5.png",label:{content:n[r]["dictValue"]+"\n"+n[r]["count"],fontSize:12,anchorX:-30,anchorY:-30,bgColor:"#874A98BB",padding:10,textAlign:"center",color:"#FFFFFF",borderRadius:99999}});case 7:case"end":return t.stop()}}),t)})))()},searchNewxyProvince:function(){var e=this;return s(i.default.mark((function t(){var a,n,r;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.markers2=[],t.next=3,e.$fetch(e.$api.xinfangProvince,{},"GET");case 3:for(r in a=t.sent,e.newHosueList=JSON.parse(JSON.stringify(a.data)),n=a.data,n.forEach((function(t){var a=new Object;a=e.bMapToTxMap(t.latitude,t.longitude),t.latitude=a.latitude,t.longitude=a.longitude})),n)"下吕浦"!=n[r]["dictValue"]&&e.markers2.push({id:r+1,latitude:n[r]["latitude"],longitude:n[r]["longitude"],alpha:1,width:5,height:5,iconPath:"../../static/icon/5.png",label:{content:n[r]["dictValue"]+"\n"+n[r]["count"],fontSize:12,anchorX:-30,anchorY:-30,bgColor:"#874A98BB",padding:10,textAlign:"center",color:"#FFFFFF",borderRadius:99999}});for(r in n)"下吕浦"==n[r]["dictValue"]&&e.markers2.push({id:r+1,latitude:n[r]["latitude"],longitude:n[r]["longitude"],alpha:1,width:5,height:5,iconPath:"../../static/icon/5.png",label:{content:n[r]["dictValue"]+"\n"+n[r]["count"],fontSize:12,anchorX:-30,anchorY:-30,bgColor:"#FE9E2E",padding:10,textAlign:"center",color:"#FFFFFF",borderRadius:99999}});case 9:case"end":return t.stop()}}),t)})))()},searchNewxyHouse:function(e,t){var a=this;return s(i.default.mark((function n(){var r,s,o;return i.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return a.markers3=[],a.markers4=[],i.next=4,a.$fetch(a.$api.xinfangHouse,{lat:e,lng:t,size:20},"GET");case 4:for(o in r=i.sent,s=r.data,s.forEach((function(e){var t=new Object;t=a.bMapToTxMap(e.latitude,e.longitude),e.latitude=t.latitude,e.longitude=t.longitude})),s)a.markers4.push({id:s[o]["areaId"],latitude:s[o]["latitude"],longitude:s[o]["longitude"],alpha:1,width:5,height:5,iconPath:"../../static/icon/5.png",label:{content:s[o]["areaName"]+"|"+s[o]["count"]+"套",fontSize:14,anchorX:-40,anchorY:-40,bgColor:"#874A98",padding:5,textAlign:"center",color:"#FFFFFF",borderRadius:20}}),a.markers3.push({id:s[o]["areaId"],latitude:s[o]["latitude"],longitude:s[o]["longitude"],alpha:1,width:25,height:19,iconPath:"../../static/icon/222.png"});case 8:case"end":return i.stop()}}),n)})))()}},onLoad:function(e){this.searchHouse(),this.searchxyProvince(),this.searchxyHouse(this.lat,this.lng),this.markers=this.markers1}};t.default=o}).call(this,a("543d")["default"])},b3dd:function(e,t,a){}},[["3efd","common/runtime","common/vendor"]]]);
(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/my/editUserInfo"],{"0511":function(e,t,a){"use strict";var n=a("678a"),r=a.n(n);r.a},"3ece":function(e,t,a){"use strict";a.r(t);var n=a("7e89"),r=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,(function(){return n[e]}))}(i);t["default"]=r.a},"678a":function(e,t,a){},"7e89":function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a("4795")),r=i(a("d66d"));function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a,n,r,i,s){try{var o=e[i](s),u=o.value}catch(c){return void a(c)}o.done?t(u):Promise.resolve(u).then(n,r)}function o(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var i=e.apply(t,a);function o(e){s(i,n,r,o,u,"next",e)}function u(e){s(i,n,r,o,u,"throw",e)}o(void 0)}))}}var u={name:"editUserInfo",data:function(){var e=this.getDate({format:!0});return{avatar:"",birthday:"",sex:"",userName:"",token:"",sexList:[{id:1,value:"男"},{id:2,value:"女"}],gender:"请选择",date:e,phone:"",isAdmin:!1}},computed:{startDate:function(){return this.getDate("start")},endDate:function(){return this.getDate("end")}},methods:{getUserInfo:function(){var e=this;return o(n.default.mark((function t(){var a,i;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isAdmin){t.next=12;break}return t.next=3,e.$fetch(e.$api.getInfo,{},"GET");case 3:a=t.sent,e.avatar=r.default.pro+"profile/avatar/"+a.data.avatar,a.data.avatar?e.avatar=r.default.pro+"profile/avatar/"+a.data.avatar:e.avatar="https://img.bajiaostar.com/FgkVAFlA5etvApeTeLEt2P0s822H",e.userName=a.data.userName,e.phone=a.data.phonenumber,e.sex=a.data.sex,0==e.sex?e.gender="男":1==e.sex&&(e.gender="女"),t.next=21;break;case 12:return t.next=14,e.$fetch(e.$api.getMyInfo,{},"GET");case 14:i=t.sent,i.data.avatar?e.avatar=r.default.pro+"profile/avatar/"+i.data.avatar:e.avatar="https://img.bajiaostar.com/FgkVAFlA5etvApeTeLEt2P0s822H",i.data.birthday&&(e.birthday=e.$dayjs(i.data.birthday).format("YYYY-MM-DD")),e.userName=i.data.userName,e.phone=i.data.phonenumber,e.sex=i.data.sex,0==e.sex?e.gender="男":1==e.sex&&(e.gender="女");case 21:case"end":return t.stop()}}),t)})))()},editAvatar:function(){var t=this;this.isAdmin?e.chooseImage({count:1,sizeType:["original","compressed"],success:function(a){for(var n=0;n<a.tempFilePaths.length;n++)e.uploadFile({url:r.default.pro+t.$api.agentEditInfo,filePath:a.tempFilePaths[n],name:"file",formData:{token:t.token},success:function(e){console.log(e),t.getUserInfo()}})}}):e.chooseImage({count:1,sizeType:["original","compressed"],success:function(a){for(var n=0;n<a.tempFilePaths.length;n++)e.uploadFile({url:r.default.pro+t.$api.userEditInfo,filePath:a.tempFilePaths[n],name:"file",formData:{token:t.token},success:function(e){console.log(e),t.getUserInfo()}})}})},editUserInfo:function(){var t=this;return o(n.default.mark((function a(){var r,i;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.isAdmin){a.next=7;break}return a.next=3,t.$fetch(t.$api.agentEditInfo,{birthday:t.birthday,sex:t.sex,userName:t.userName},"POST","from");case 3:r=a.sent,e.showToast({icon:"none",title:r.msg}),a.next=11;break;case 7:return a.next=9,t.$fetch(t.$api.userEditInfo,{birthday:t.birthday,sex:t.sex,userName:t.userName},"POST","from");case 9:i=a.sent,e.showToast({icon:"none",title:i.msg});case 11:case"end":return a.stop()}}),a)})))()},sexChange:function(e){for(var t in this.sexList)t==e.target.value&&(this.sex=t,this.gender=this.sexList[t].value,this.editUserInfo())},dateChange:function(e){this.birthday=e.target.value,this.editUserInfo()},getDate:function(e){var t=new Date,a=t.getFullYear(),n=t.getMonth()+1,r=t.getDate();return"start"===e?a-=60:"end"===e&&(a+=2),n=n>9?n:"0"+n,r=r>9?r:"0"+r,"".concat(a,"-").concat(n,"-").concat(r)},editUserName:function(){e.navigateTo({url:"editUserName?userName="+this.userName})}},onShow:function(){e.getStorageSync("isAdmin")&&(this.isAdmin=e.getStorageSync("isAdmin")),this.getUserInfo(),this.token=e.getStorageSync("token")}};t.default=u}).call(this,a("543d")["default"])},a317:function(e,t,a){"use strict";var n,r=function(){var e=this,t=e.$createElement;e._self._c},i=[];a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return n}))},c5d7:function(e,t,a){"use strict";(function(e){a("ceaf");n(a("66fd"));var t=n(a("fb93"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("543d")["createPage"])},fb93:function(e,t,a){"use strict";a.r(t);var n=a("a317"),r=a("3ece");for(var i in r)"default"!==i&&function(e){a.d(t,e,(function(){return r[e]}))}(i);a("0511");var s,o=a("f0c5"),u=Object(o["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);t["default"]=u.exports}},[["c5d7","common/runtime","common/vendor"]]]);
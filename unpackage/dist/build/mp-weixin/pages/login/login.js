(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"026a":function(e,t,n){},2613:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("4795"));function a(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,o,a,i,r){try{var c=e[i](r),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(o,a)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function c(e){i(r,o,a,c,s,"next",e)}function s(e){i(r,o,a,c,s,"throw",e)}c(void 0)}))}}var c=null,s=n("e109"),u={name:"login",data:function(){return{loginType:1,mobile:"",height:64,top:0,scrollH:0,opcity:0,iconOpcity:0,password:"",openId:"",manager:"",code:"",openid:"",session_key:"",appId:"wx685226499ed8d55c",verCode:"",count:60,verificationFlag:!1,windowHeight:1334}},methods:{back:function(){e.navigateBack({delta:1})},changeLoginType:function(e){this.loginType=e},GetPhoneNumber:function(t){if(console.log(t),"getPhoneNumber:fail user deny"==t.detail.errMsg)e.showModal({title:"提示",showCancel:!0,content:"您取消了授权"});else{var n=new s(this.appId,this.session_key),o=n.decryptData(t.detail.encryptedData,t.detail.iv);this.wxLogin(o.phoneNumber)}},wxLogin:function(t){var n=this;return r(o.default.mark((function a(){var i,r;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(!n.manager){o.next=8;break}return o.next=3,n.$fetch(n.$api.wxLogin,{mobile:t,openId:n.openid,manager:n.manager},"GET");case 3:i=o.sent,e.showToast({icon:"none",title:i.msg}),0!=i.code&&1001!=i.code||(e.setStorageSync("isAdmin",!1),e.setStorageSync("isToken",!0),e.setStorageSync("token",i.data.token),e.navigateBack({delta:1})),o.next=13;break;case 8:return o.next=10,n.$fetch(n.$api.wxLogin,{mobile:t,openId:n.openid},"GET");case 10:r=o.sent,e.showToast({icon:"none",title:r.msg}),0!=r.code&&1001!=r.code||(e.setStorageSync("isAdmin",!1),e.setStorageSync("isToken",!0),e.setStorageSync("token",r.data.token),e.navigateBack({delta:1}));case 13:case"end":return o.stop()}}),a)})))()},agentLogin:function(){var t=this;return r(o.default.mark((function n(){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$fetch(t.$api.login,{loginName:t.mobile,pwd:t.password},"GET");case 2:a=n.sent,e.showToast({icon:"none",title:a.msg}),0==a.code&&(e.setStorageSync("isAdmin",!0),e.setStorageSync("isToken",!0),e.setStorageSync("token",a.data.token),e.setStorageSync("userId",a.data.client.userId),e.navigateBack({delta:1}));case 5:case"end":return n.stop()}}),n)})))()},userLogin:function(){var t=this;return r(o.default.mark((function n(){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$fetch(t.$api.h5userLogin,{mobile:t.mobile,verification:t.verCode,manager:t.manager},"GET");case 2:a=n.sent,console.log(a),e.showToast({icon:"none",title:a.msg}),0!=a.code&&1001!=a.code||(e.setStorageSync("isAdmin",!1),e.setStorageSync("isToken",!0),e.setStorageSync("token",a.data.token),e.navigateBack({delta:1}));case 6:case"end":return n.stop()}}),n)})))()},sendVerification:function(){var t=this;return r(o.default.mark((function n(){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.$u.test.mobile(t.mobile)){n.next=2;break}return n.abrupt("return",e.showToast({icon:"none",title:"手机号码不正确或未填写"}));case 2:return t.verificationFlag=!0,n.next=5,t.$fetch(t.$api.sendCode,{mobile:t.mobile},"GET");case 5:a=n.sent,console.log(a),c=setInterval((function(){0==t.count&&(clearInterval(c),t.verificationFlag=!1,t.count=60),t.count=--t.count}),1e3);case 8:case"end":return n.stop()}}),n)})))()},getCode:function(){var t=this;e.login({provider:"weixin",success:function(e){e.code&&(t.code=e.code,t.getOpenId())}})},getOpenId:function(){var t=this;return r(o.default.mark((function n(){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$fetch(t.$api.getOpenId,{js_code:t.code},"GET");case 2:a=n.sent,t.openid=a.data.openid,e.setStorageSync("openId",t.openid),t.session_key=a.data.session_key,e.setStorageSync("session_key",t.session_key);case 7:case"end":return n.stop()}}),n)})))()}},onLoad:function(){var t=this,n={};n=wx.getMenuButtonBoundingClientRect(),e.getSystemInfo({success:function(e){t.windowHeight=2*e.screenHeight,t.width=n.left||e.windowWidth,t.height=n.top?n.top+n.height+8:e.statusBarHeight+44,t.top=n.top?n.top+(n.height-32)/2:e.statusBarHeight+6,t.scrollH=e.windowWidth}})},onShow:function(){this.getCode(),e.getStorageSync("manager")&&(this.manager=e.getStorageSync("manager"))},onUnload:function(){c&&clearInterval(c)}};t.default=u}).call(this,n("543d")["default"])},"3c35":function(e,t,n){"use strict";var o=n("026a"),a=n.n(o);a.a},"512e":function(e,t,n){"use strict";n.r(t);var o=n("61f6"),a=n("658e");for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n("3c35");var r,c=n("f0c5"),s=Object(c["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],r);t["default"]=s.exports},"61f6":function(e,t,n){"use strict";var o,a=function(){var e=this,t=e.$createElement;e._self._c},i=[];n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}))},"658e":function(e,t,n){"use strict";n.r(t);var o=n("2613"),a=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},b76e:function(e,t,n){"use strict";(function(e){n("ceaf");o(n("66fd"));var t=o(n("512e"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])}},[["b76e","common/runtime","common/vendor"]]]);